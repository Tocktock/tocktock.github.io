<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     NestJS ë¸”ë¡œê·¸ ë§Œë“¤ê¸° - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° &middot; ì˜ì› 
  </title>

  
  <link rel="canonical" href="https://tocktock.github.io/nestjs/nestjs-3-database/" />
  

  <link rel="stylesheet" href="https://tocktock.github.io/public/css/poole.css" />
  <link rel="stylesheet" href="https://tocktock.github.io/public/css/syntax.css" />
  <link rel="stylesheet" href="https://tocktock.github.io/public/css/lanyon.css" />

  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400"
  />

  <link
    rel="apple-touch-icon-precomposed"
    sizes="144x144"
    href="https://tocktock.github.io/public/apple-touch-icon-precomposed.png"
  />
  <link rel="shortcut icon" href="https://tocktock.github.io/public/favicon.ico" />

  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="https://tocktock.github.io/atom.xml"
  />

  <!-- <script>
    (function (i, s, o, g, r, a, m) {
      i["GoogleAnalyticsObject"] = r;
      (i[r] =
        i[r] ||
        function () {
          (i[r].q = i[r].q || []).push(arguments);
        }),
        (i[r].l = 1 * new Date());
      (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m);
    })(
      window,
      document,
      "script",
      "//www.google-analytics.com/analytics.js",
      "ga"
    );
    ga("create", "UA-178749172-1", "auto");
    ga("send", "pageview");
  </script> -->
</head>


  <body>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" />

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item description">
    <p>Developer with Cat</p>
  </div>

  <nav class="sidebar-nav">
    <a
      class="sidebar-nav-item"
      href="https://tocktock.github.io/"
      >Home</a
    >
                
    <div>
      <a
        class="sidebar-nav-item"
        href="https://tocktock.github.io/about/"
        >About me</a
      >
               
    <div>
      <a
        class="sidebar-nav-item"
        href="https://tocktock.github.io/categories/"
        >Categories</a
      >
      
      <ul class="sidebar-categories">
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/Algorithms"
            >Algorithms (28)</a
          >
        </li>
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/Jekyll"
            >Jekyll (1)</a
          >
        </li>
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/elasticsearch"
            >elasticsearch (9)</a
          >
        </li>
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/NestJS"
            >NestJS (3)</a
          >
        </li>
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/DevTip"
            >DevTip (1)</a
          >
        </li>
         
        <li class="sidebar-categories-item">
          <a href="https://tocktock.github.io/categories/nodejs"
            >nodejs (1)</a
          >
        </li>
        
      </ul>
                                                                   
    </div>

    <a class="sidebar-nav-item" href="https://github.com/Tocktock/tocktock.github.io">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>&copy; 2021. All rights reserved.</p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">ì˜ì›</a>
            <small>ì›¹ ê°œë°œê³¼ ì¼ìƒ</small>
          </h3>
        </div>
      </div>

      <div class="container content"><div class="post">
  <h1 class="post-title">NestJS ë¸”ë¡œê·¸ ë§Œë“¤ê¸° - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°</h1>
  <span class="post-date">01 Feb 2021</span>
  <h1 id="2-nestjs-ë¸”ë¡œê·¸-ë§Œë“¤ê¸°---ë°ì´í„°ë² ì´ìŠ¤-ì—°ê²°-postgresqlê³¼-user-ëª¨ë“ˆ">2. NestJS ë¸”ë¡œê·¸ ë§Œë“¤ê¸° - ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° (Postgresql)ê³¼ User ëª¨ë“ˆ</h1>

<hr />

<blockquote>
  <p>ì €ëŠ” ì˜¤ëŠ˜ í¬ìŠ¤íŒ…í•  ë¶„ëŸ‰ì˜ ì•±ì„ ë§Œë“  í›„ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…í•˜ê¸° ë•Œë¬¸ì— ì¤‘ê°„ì— ì˜¤ë¥˜ê°€ ìƒê¸¸ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
ì˜¤ë¥˜ ë‚´ìš©ê³¼ í•¨ê»˜ ëŒ“ê¸€ì„ ë‹¬ì•„ì£¼ì‹œë©´ ì €ë„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤!!</p>
</blockquote>

<h2 id="-ë°ì´í„°-ë² ì´ìŠ¤-ì—°ê²°í•˜ê¸°-">ğŸ‘Œ ë°ì´í„° ë² ì´ìŠ¤ ì—°ê²°í•˜ê¸° !!</h2>

<h3 id="postgresql-ì„¤ì¹˜">PostgreSQL ì„¤ì¹˜!!</h3>

<p>ì—¬ëŸ¬ë¶„ ë“œë””ì–´ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•  ì‹œê°„ì´ ì™”ìŠµë‹ˆë‹¤!!.
ì‹¤ì œ ì—°ìŠµí•  ë•ŒëŠ” ë°°ì—´ ê°™ì€ ì„ì˜ ì ì¸ ë†ˆì„ ë§Œë“¤ê³  ë‚˜ì„œ í•˜ê¸´í•˜ì§€ë§Œâ€¦ ë°”ë¡œ ì—°ê²°í•´ë³´ì£ !</p>

<p>ì €í¬ëŠ” Postgresql ì„ ì‚¬ìš©í•  ê²ë‹ˆë‹¤!! ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì…”ë„ ë©ë‹ˆë‹¤!!</p>

<blockquote>
  <p>Postgresql ì€ ì˜¤í”ˆì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ë¡œ SQL í‘œì¤€ì„ ì˜ ì§€ì›í•©ë‹ˆë‹¤. ì¼ë‹¨ ë¬´ë£Œì…ë‹ˆë‹¤!!
ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì€ ì •ì‹ ë¬¸ì„œë‚˜ íƒ€ ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”. <a href="https://junlab.tistory.com/177">postgresql ì„¤ì¹˜ë°©ë²•</a></p>
</blockquote>

<p>í¸ì˜ë¥¼ ìœ„í•´ pgAdmin íˆ´ì„ ì´ìš©í•˜ì—¬ postgresql ì„ ì œì–´í•˜ê² ìŠµë‹ˆë‹¤.!!</p>

<p>ê¸°ì¡´ì˜ ì„œë²„ (PostgreSQL 13 ì´êµ°ìš” ì €ëŠ”) ë¥¼ ìš°í´ë¦­í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§Œë“­ì‹œë‹¤!!
ì €ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ <code class="language-plaintext highlighter-rouge">nest_blog</code> ë¼ê³  í–ˆìŠµë‹ˆë‹¤!!</p>

<blockquote>
  <p>ì›í•˜ì‹œëŠ” ì„œë²„ë¥¼ ë§Œë“¤ê³  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•˜ì…”ë„ ê´œì°®ìŠµë‹ˆë‹¤.</p>
</blockquote>

<p>ë°ì´í„°ë² ì´ìŠ¤ì˜ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°ì— ëŒ€í•´ì„œëŠ” ì•„ì§ ì •ì˜í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤. NestJSê°€ í•´ì¤„ê±°ê±°ë“ ìš”!!</p>

<h3 id="typeorm-">TypeORM !!</h3>

<p>TypeORM ì€ NodeJS í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ORM (Object Relational Mapping) ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤!!</p>

<blockquote>
  <p>ORM ì€ ê°„ë‹¨íˆ ë§í•´ Object ë¥¼ Database ìŠ¤í‚¤ë§ˆì— ì ì ˆí•˜ê²Œ ì ìš©ì‹œí‚¤ê²Œ í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ë¼ ìƒê°í•˜ë©´ í¸í•©ë‹ˆë‹¤.!!</p>
</blockquote>

<p>ì„¤ì¹˜ ì„¤ì¹˜~ nestjs ë£¨íŠ¸ í´ë”ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•´ì£¼ì„¸ìš” !!</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nv">$ </span>npm <span class="nb">install </span>typeorm @nestjs/typeorm <span class="nt">--save</span>
</code></pre></div></div>

<p>ì„¤ì¹˜ê°€ ë¬ìœ¼ë©´ <code class="language-plaintext highlighter-rouge">ormconfig.json</code> ì´ë¼ëŠ” íŒŒì¼ì„ ë£¨íŠ¸ í´ë”ì— ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.
ë‚˜ì¤‘ì— TypeORM ëª¨ë“ˆì´ ì´ íŒŒì¼ì„ ì°¸ê³ í•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°ì„ ì‹œë„í•©ë‹ˆë‹¤!!</p>

<p>ë‹¤ìŒê³¼ ê°™ì´ ì…ë ¥í•´ì£¼ì„¸ìš”!!</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postgres"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">5432</span><span class="p">,</span><span class="w">
  </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"postgres"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"password"</span><span class="p">:</span><span class="w"> </span><span class="err">ì—¬ëŸ¬ë¶„ì´</span><span class="w"> </span><span class="err">ì„¤ì •í–ˆë˜</span><span class="w"> </span><span class="err">ë¹„ë°€ë²ˆí˜¸!</span><span class="p">,</span><span class="w">
  </span><span class="nl">"database"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nest_blog"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"entities"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"dist/**/**.entity{.ts,.js}"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"synchronize"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">type</code> : ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ê²Œ ë  ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">host</code> : db ì—°ê²° ì£¼ì†Œì…ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">localhost</code> ë¥¼ ì´ìš©í•˜ê³  db ë¥¼ ë‹¤ë¥¸ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰í•œë‹¤ë©´ ê·¸ ë¨¸ì‹ ì— ì ‘ì†í•˜ê¸° ìœ„í•œ ì£¼ì†Œë¡œ ë³€ê²½í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">port</code> : db ì—°ê²° í¬íŠ¸ ì…ë‹ˆë‹¤. ê¸°ë³¸ì€ <code class="language-plaintext highlighter-rouge">5432</code> ì…ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">username</code> : ë³„ ë‹¤ë¥¸ ì„¤ì •ì„ ì•ˆí–ˆë‹¤ë©´ <code class="language-plaintext highlighter-rouge">postgres</code> ì…ë‹ˆë‹¤</li>
  <li><code class="language-plaintext highlighter-rouge">password</code> : ì„¤ì¹˜ ê³¼ì •ì—ì„œ ì„¤ì •í–ˆë˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</li>
  <li><code class="language-plaintext highlighter-rouge">database</code> : ìœ„ì—ì„œ ë§Œë“¤ì—ˆë˜ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì´ë¦„ì„ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ì €ëŠ” <code class="language-plaintext highlighter-rouge">nest_blog</code> ë¼ê³  í–ˆìŠµë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">entities</code> : ë°˜ë“œì‹œ <code class="language-plaintext highlighter-rouge">dist</code> ì•„ë˜ì˜ í´ë”ë¡œ ì§€ì •í•´ì£¼ì„¸ìš”. ì•ˆê·¸ëŸ¬ë©´ ì˜¤ë¥˜ë‚  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ ì„¤ì •ì˜ ê²½ë¡œì— ìˆëŠ” íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ DB ì—ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ì„¤ì •í•˜ê²Œ ë©ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">synchronize</code> : ì´ ì„¤ì •ì„ true ë¡œ í•˜ì‹œë©´ ì•± ì‘ë™ì‹œ DB ìŠ¤í‚¤ë§ˆê°€ ìë™ìœ¼ë¡œ ìƒì„±ë˜ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>

<blockquote>
  <p>ìì„¸í•œ ë‚´ìš©ì€ <a href="https://typeorm.io/#/using-ormconfig">ormconfig íƒë°©í•˜ê¸°!!</a> ì„ ì°¸ì¡°í•´ì£¼ì„¸ìš”~</p>
</blockquote>

<h3 id="app-ëª¨ë“ˆì—ì„œ-import--ê·¸ë¦¬ê³ -ì‹¤í–‰">app ëª¨ë“ˆì—ì„œ import !! ê·¸ë¦¬ê³  ì‹¤í–‰!!</h3>

<p>ì ì´ì œ <code class="language-plaintext highlighter-rouge">app.moudle.ts</code> íŒŒì¼ë¡œ ê°€ì„œ TypeOrmMoudle ì„ import í•´ì¤ì‹œë‹¤!!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span><span class="nx">UsersModule</span><span class="p">,</span> <span class="nx">TypeOrmModule</span><span class="p">.</span><span class="nx">forRoot</span><span class="p">()],</span>
  <span class="na">controllers</span><span class="p">:</span> <span class="p">[</span><span class="nx">AppController</span><span class="p">],</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span><span class="nx">AppService</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ormconfig.json</code> íŒŒì¼ì„ ìƒì„±í•˜ì§€ ì•Šì•˜ë‹¤ë©´, forRoot í•¨ìˆ˜ ì•ˆì— ì„¤ì • ë‚´ìš©ì„ ì ìœ¼ì…”ì•¼ í•©ë‹ˆë‹¤.!!
íŒŒì¼ë¡œ ê´€ë¦¬í•˜ëŠ”ê²Œ ë” í¸í•˜ê² ì£ ~?</p>

<p>ì ì´ì œ ë£¨íŠ¸ í´ë”ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•´ë´…ì‹œë‹¤!</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm run start
</code></pre></div></div>

<p>ë³„ ë‹¤ë¥¸ ì˜¤ë¥˜ê°€ ì—†ë‹¤ë©´ ì •ìƒì ìœ¼ë¡œ ì—°ê²° ëœê²ë‹ˆë‹¤!! ìš°ë¼í•˜!!!
ì €í¬ëŠ” ì•„ì§ Entityì— ëŒ€í•´ì„œ ì„¤ì •ì„ í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— í…Œì´ë¸”ì— ë³„ ë‚´ìš©ì€ ì—†ìŠµë‹ˆë‹¤.</p>

<p>ì´í›„ì— Entity ë¥¼ ë§Œë“  í›„ì—ëŠ” DB ì—ì„œ í…Œì´ë¸”ì„ ì‚­ì œí•˜ê³  ë‹¤ì‹œ ì—°ê²°í•´ì£¼ì‹œë©´ ë§Œë“  ë‚´ìš©ì´ ì ìš©ë©ë‹ˆë‹¤!</p>

<h2 id="-user-entity-ë§Œë“¤ê¸°">ğŸ›´ User Entity ë§Œë“¤ê¸°.</h2>

<p>í†¡.</p>

<p>DB ë„ ì—°ê²°í–ˆê² ë‹¤.</p>

<p>í†¡í†¡.</p>

<p>User Entity Template ë„ ìƒì„±í–ˆê² ë‹¤.</p>

<p>í†¡í†¡.</p>

<p>ë‚´ìš©ë§Œ ë„£ìœ¼ë©´ ë˜ë„¤?</p>

<p>ì§!</p>

<p><code class="language-plaintext highlighter-rouge">src/users</code> ì•ˆì˜ êµ¬ì¡°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í•´ì£¼ì„¸ìš”!!
spec íŒŒì¼ë“¤ì€ ì§€ê¸ˆ ì—†ì–´ë„ ë©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>users
â”‚  users.repository.ts
â”‚  users.controller.spec.ts
â”‚  users.controller.ts
â”‚  users.entity.ts
â”‚  users.module.ts
â”‚  users.service.spec.ts
â”‚  users.service.ts
â”‚
â””â”€dto
        create-user.dto.ts
        index.ts
        update-user.dto.ts
</code></pre></div></div>

<p>ìš°ë¦¬ëŠ” User ì˜ ìš”êµ¬ì‚¬í•­ ë§ê²Œ ì ì ˆíˆ Entity ë¥¼ ì„¤ê³„í•´ì•¼ í•©ë‹ˆë‹¤. ì™œëƒë©´ ì´ ì•ˆì— ìˆëŠ” ë‚´ìš©ì´ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆë¡œ ì ìš©ë  ë…€ì„ë“¤ì´ê±°ë“ ìš”!!</p>

<p><a href="https://github.com/Tocktock/nest-practice">ìš”êµ¬ì‚¬í•­ë³´ê¸°</a></p>

<p>ë°”ë¡œ ëª¨ë“  ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±ì‹œí‚¤ê¸°ëŠ” ë³µì¡í•˜ë‹ˆ í•  ìˆ˜ ìˆëŠ”ê±° ë¨¼ì € ì±„ì›Œ ë‚˜ê°‘ì‹œë‹¤!!</p>

<p><code class="language-plaintext highlighter-rouge">users.entity.ts</code> ì•ˆì„ ë‹¤ìŒê³¼ ê°™ì´ ì±„ì›Œì£¼ì„¸ìš”!!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">BeforeInsert</span><span class="p">,</span> <span class="nx">Column</span><span class="p">,</span> <span class="nx">Entity</span><span class="p">,</span> <span class="nx">PrimaryGeneratedColumn</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">typeorm</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">argon2</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">argon2</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">Entity</span><span class="p">(</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserEntity</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">PrimaryGeneratedColumn</span><span class="p">()</span>
  <span class="nx">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">length</span><span class="p">:</span> <span class="mi">32</span> <span class="p">})</span>
  <span class="nx">username</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">unique</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
  <span class="nx">email</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">()</span>
  <span class="nx">password</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">BeforeInsert</span><span class="p">()</span>
  <span class="k">async</span> <span class="nx">hashPassword</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">argon2</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="p">@</span><span class="nd">Column</span><span class="p">({</span> <span class="na">default</span><span class="p">:</span> <span class="dl">""</span> <span class="p">})</span>
  <span class="nx">imageLink</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Entity</code> : ì´ annotation ì´ ìˆìœ¼ë©´ nestjsê°€ ë³´ê³  ìˆë‹¤ê°€ DB ìŠ¤í‚¤ë§ˆ ì ìš©ì„ ìœ„í•´ ì°¸ê³ í•˜ê²Œ ë©ë‹ˆë‹¤!! ì´í›„ repository í´ë˜ìŠ¤ì—ì„œë„ ì°¸ê³ í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ê°€ ë©ë‹ˆë‹¤. ê´„í˜¸ì•ˆì— ë„£ì€ ë‚´ìš©ì´ í…Œì´ë¸”ì˜ ì´ë¦„ì´ ë©ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">PrimaryGeneratedColumn</code> : ì´ annotionì´ ìˆë‹¤ë©´ ì´ í…Œì´ë¸”ì€ í•´ë‹¹ í•„ë“œê°€ primary key ê°€ ë©ë‹ˆë‹¤. ê´„í˜¸ ì•ˆì— ì•„ë¬´ëŸ° ë‚´ìš©ì„ ë„£ì§€ ì•Šìœ¼ë©´ id ëŠ” auto increment ê°€ ì ìš©ë©ë‹ˆë‹¤.
    <blockquote>
      <p><a href="https://velog.io/@qnfmtm666/series/DevTip">uuid vs auto increment</a></p>
    </blockquote>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Column</code> : ì´ annotion ì´ ìˆìœ¼ë©´ í…Œì´ë¸”ì˜ í•„ë“œë¡œ ë§Œë“¤ì–´ì§€ê²Œ ë©ë‹ˆë‹¤. ê´„í˜¸ ì•ˆì— ì—¬ëŸ¬ ì˜µì…˜ì„ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <a href="https://typeorm.io/#/entities/column-options">ëª¨ë“  ê´„í˜¸ ì•ˆì˜ ì˜µì…˜ ë³´ê¸°</a></li>
  <li><code class="language-plaintext highlighter-rouge">BeforeInsert</code> : ìš” ë…€ì„ì€ ë°ì´í„°ë² ì´ìŠ¤ì— insert í•˜ê¸° ì „ì— ìˆ˜í–‰ë˜ëŠ” ë…€ì„ì…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³µí˜¸í™” í•  ìˆ˜ ì—†ê²Œ hash í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì €ì¥í•©ì‹œë‹¤.</li>
</ul>

<p>ì•„ì°¸ í•´ì‰¬ í•¨ìˆ˜ë¥¼ ì“°ê¸° ìœ„í•´ argon2 ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm <span class="nb">install </span>argon2 <span class="nt">--save</span>
</code></pre></div></div>

<h2 id="-repository-ì™€-dto-ë³€ê²½í•˜ê¸°">ğŸ”¨ Repository ì™€ Dto ë³€ê²½í•˜ê¸°!</h2>

<h3 id="repository">Repository</h3>

<p><code class="language-plaintext highlighter-rouge">Repository</code> ëŠ” ìš°ë¦¬ê°€ ë§Œë“  Entity ë¥¼ ê´€ë¦¬(insert, update, delete, load, etc.)í•´ì¤„ ë…€ì„ì´ë¼ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">users.repository.ts</code> ì•ˆì˜ ë‚´ìš©ì„ ë‹¤ìŒê³¼ ê°™ì´ ì±„ì›Œì£¼ì„¸ìš”!!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">EntityRepository</span><span class="p">,</span> <span class="nx">Repository</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">typeorm</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">UserEntity</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./users.entity</span><span class="dl">"</span><span class="p">;</span>

<span class="p">@</span><span class="nd">EntityRepository</span><span class="p">(</span><span class="nx">UserEntity</span><span class="p">)</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UserRepository</span> <span class="kd">extends</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">UserEntity</span><span class="o">&gt;</span> <span class="p">{}</span>
</code></pre></div></div>

<p>ì—¥? ì´ê²ƒë§Œ í•´ë„ ë˜ëŠ”ê±´ê°€??</p>

<ul>
  <li>ë„¤!!</li>
</ul>

<p>ì´ë ‡ê²Œ Repository ë¥¼ ë§Œë“¤ì–´ì£¼ì‹œë©´ UserEntityì— ëŒ€í•´ ê¸°ë³¸ì ì¸ ì¿¼ë¦¬ë¥¼ ê·¸ëƒ¥ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë³µì¡í•œ ì¿¼ë¦¬ëŠ” ì—¬ê¸°ì„œ ë§Œë“¤ì–´ì£¼ì…”ë„ ë˜ê³  ì´í›„ ë‚˜ì˜¬ query builder ë¡œ í•´ë‹¹ í´ë˜ìŠ¤ì—ì„œ ì“°ì…”ë„ ë©ë‹ˆë‹¤!</p>

<h3 id="dto">DTO</h3>

<p><strong>DTO</strong>(Data Transfer Object) ëŠ” ë°ì´í„°ê°€ ì–´ë–¤ êµ¬ì¡°ë¡œ ì „ì†¡ë˜ëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” í´ë˜ìŠ¤ ì…ë‹ˆë‹¤.</p>

<p>dto í´ë” ì•ˆì—
<code class="language-plaintext highlighter-rouge">create-user.dto.ts</code> í´ë”ì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•´ì£¼ì„¸ìš”</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">IsNotEmpty</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">class-validator</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">CreateUserDto</span> <span class="p">{</span>
  <span class="p">@</span><span class="nd">IsNotEmpty</span><span class="p">()</span>
  <span class="k">readonly</span> <span class="nx">username</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">IsNotEmpty</span><span class="p">()</span>
  <span class="k">readonly</span> <span class="nx">email</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="p">@</span><span class="nd">IsNotEmpty</span><span class="p">()</span>
  <span class="k">readonly</span> <span class="nx">password</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">class-validator</code> ëŠ” data ê°€ ì „ì†¡ë  ë•Œ í•´ë‹¹ í•„ë“œê°€ ì ì ˆí•œ ìœ íš¨ì„±ì„ ê°€ì§€ëŠ”ì§€ ê²€ì‚¬í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤.</p>

<p>ì ì´ì œ Service ë§Œ ë°”ê¾¸ë©´ ë©ë‹ˆë‹¤!!</p>

<h2 id="-user-service-ë³€ê²½í•˜ê¸°">ğŸ¤— User Service ë³€ê²½í•˜ê¸°!!</h2>

<p>ì êµ¬ì¡°ëŠ” ì¤€ë¹„ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë¡œì§ë§Œ ì˜ ì‘ì„±í•´ì£¼ë©´ ë©ë‹ˆë‹¤ í™”ì´íŒ…!!</p>

<p>ë¨¼ì € ì˜ì¡´ì„± ì£¼ì…ì„ ìœ„í•´ UserService ìƒì„±ìì— ë‹¤ìŒê³¼ ê°™ì´ ì ì–´ì¤ì‹œë‹¤!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="k">readonly</span> <span class="nx">userRepository</span><span class="p">:</span> <span class="nx">UserRepository</span><span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>ì ì´ê²ƒ ë§Œìœ¼ë¡œ ê°ì²´ê°€ ì£¼ì…ë¬ìŠµë‹ˆë“œì–´ì–´ì–´!! ì–¼ë§ˆë‚˜ ì¢‹ì•„~!</p>

<h3 id="user-create">User create</h3>

<p><code class="language-plaintext highlighter-rouge">users.service.ts</code> íŒŒì¼ ë‚´ì— create í•¨ìˆ˜ ì•ˆì„ ë‹¤ìŒê³¼ ê°™ì´ ë°”ê¿”ì£¼ì„¸ìš”!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">async</span> <span class="nx">create</span><span class="p">(</span><span class="nx">createUserDto</span><span class="p">:</span> <span class="nx">CreateUserDto</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">createUserDto</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">getByUserName</span> <span class="o">=</span> <span class="nx">getRepository</span><span class="p">(</span><span class="nx">UserEntity</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">createQueryBuilder</span><span class="p">(</span><span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">'</span><span class="s1">user.username = :username</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span> <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">byUserName</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getByUserName</span><span class="p">.</span><span class="nx">getOne</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">byUserName</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">error</span> <span class="o">=</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="dl">'</span><span class="s1">UserName is already exists</span><span class="dl">'</span> <span class="p">};</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpException</span><span class="p">(</span>
        <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Input data validation falied</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span> <span class="p">},</span>
        <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">BAD_REQUEST</span><span class="p">,</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">getByEmail</span> <span class="o">=</span> <span class="nx">getRepository</span><span class="p">(</span><span class="nx">UserEntity</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">createQueryBuilder</span><span class="p">(</span><span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">'</span><span class="s1">user.email = :email</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span> <span class="p">});</span>

    <span class="kd">const</span> <span class="nx">byEmail</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getByEmail</span><span class="p">.</span><span class="nx">getOne</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">byEmail</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">error</span> <span class="o">=</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">'</span><span class="s1">email is already exists</span><span class="dl">'</span> <span class="p">};</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpException</span><span class="p">(</span>
        <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Input data validation falied</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span> <span class="p">},</span>
        <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">BAD_REQUEST</span><span class="p">,</span>
      <span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// const thisUser = this.userRepository.findOne({ username: username });</span>
    <span class="c1">// const thisEmail = this.userRepository.findOne({ email: email });</span>

    <span class="c1">// create new user</span>
    <span class="kd">let</span> <span class="nx">newUser</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UserEntity</span><span class="p">();</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">password</span> <span class="o">=</span> <span class="nx">password</span><span class="p">;</span>
    <span class="nx">newUser</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="nx">username</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">validate_error</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">validate</span><span class="p">(</span><span class="nx">newUser</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">validate_error</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">_error</span> <span class="o">=</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="dl">'</span><span class="s1">UserInput is not valid check type</span><span class="dl">'</span> <span class="p">};</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nx">HttpException</span><span class="p">(</span>
        <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Input data validation failed</span><span class="dl">'</span><span class="p">,</span> <span class="nx">_error</span> <span class="p">},</span>
        <span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">BAD_REQUEST</span><span class="p">,</span>
      <span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">newUser</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>ë¨¼ì € username ê³¼ email ì€ ìœ ì¼í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ ê²€ì‚¬í•´ë³´ì£ !!</p>

<p>ë¨¼ì € ì‚´í´ë³¼ ê²ƒì€ <code class="language-plaintext highlighter-rouge">createQueryBuilder</code> ì…ë‹ˆë‹¤.
typeorm ì€ <code class="language-plaintext highlighter-rouge">createQueryBuilder</code> ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ì½”ë“œ ì•ˆì—ì„œ SQL ë¬¸ì„ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.
ì´ ì½”ë“œë¡œ ì¸í•´ ì‘ì„±ëœ sql ë¬¸ì€ ë°”ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì‹¤ì§ˆì ìœ¼ë¡œ DB ì™€ ë°ì´í„° êµí™˜ì´ ì¼ì–´ë‚˜ë©´ ì‹¤í–‰ ë©ë‹ˆë‹¤.</p>

<p>ë§¨ ì²˜ìŒ ë§Œë“  SQL ë¬¸ì€</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">byEmail</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getByEmail</span><span class="p">.</span><span class="nx">getOne</span><span class="p">();</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ ìˆ˜í–‰ ë©ë‹ˆë‹¤. DB ì˜ ì¿¼ë¦¬ ì†ë„ì™€ ìš°ë¦¬ê°€ ë§Œë“  ë°±ì—”ë“œ ì„œë²„ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì†ë„ ì°¨ì´ê°€ ë§ì´ ë‚˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° ì‹ìœ¼ë¡œ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤.</p>

<p>ë§ˆì°¬ê°€ì§€ë¡œ username ë„ ê²€ì‚¬í•´ì¤ì‹œë‹¤!!</p>

<p>ì‚¬ì‹¤ ì´ ê¸°ëŠ¥ì€ createQueryBuilder ë¥¼ ì•ˆì¨ë„ ë©ë‹ˆë‹¤. Repository ë¥¼ ì‘ì„±í–ˆìœ¼ë¯€ë¡œ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì€ ì´ë¯¸ ì§€ì›ì´ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
ì˜ˆë“¤ ë“¤ì–´ username ì„ ê¸°ì¤€ìœ¼ë¡œ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì ìœ¼ë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">username</span><span class="p">:</span> <span class="nx">username</span> <span class="p">});</span>
</code></pre></div></div>

<p>ì´í•´ë¥¼ ë•ê³ ì <code class="language-plaintext highlighter-rouge">createQueryBuilder</code> ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤</p>

<p>ë§ˆì°¬ê°€ì§€ë¡œ findByEmail í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ì‹œë©´</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">async</span> <span class="nx">findByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>email ê¸°ì¤€ìœ¼ë¡œ ìœ ì €ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!!</p>

<h2 id="-module-ì—-import-í•´ì£¼ê¸°">ğŸ”¨ Module ì— import í•´ì£¼ê¸°!!</h2>

<p>ì ê±°ì˜ ë‹¤ ì™”ìŠµë‹ˆë‹¤!!</p>

<p><code class="language-plaintext highlighter-rouge">users.module.ts</code> íŒŒì¼ ì•ˆì— imports ë¶€ë¶„ì— ë‹¤ìŒê³¼ ê°™ì´ ëª¨ë“ˆì„ import í•´ì¤ì‹œë‹¤!!</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Module</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span><span class="nx">TypeOrmModule</span><span class="p">.</span><span class="nx">forFeature</span><span class="p">([</span><span class="nx">UserRepository</span><span class="p">])],</span>
  <span class="na">controllers</span><span class="p">:</span> <span class="p">[</span><span class="nx">UsersController</span><span class="p">],</span>
  <span class="na">providers</span><span class="p">:</span> <span class="p">[</span><span class="nx">UsersService</span><span class="p">],</span>
  <span class="na">exports</span><span class="p">:</span> <span class="p">[</span><span class="nx">UsersService</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">UsersModule</span> <span class="p">{}</span>
</code></pre></div></div>

<h2 id="-ì´ì œ-ì‹¤í–‰ëœë‹¤">ğŸ˜ƒ ì´ì œ ì‹¤í–‰ëœë‹¤!!</h2>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm run start
</code></pre></div></div>

<p>ìœ„ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì„ í•©ì‹œë‹¤.
ì˜¤ë¥˜ê°€ ì—†ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë¡œê·¸ê°€ ëœ¹ë‹ˆë‹¤!!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [NestFactory] Starting Nest application...
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [InstanceLoader] TypeOrmModule dependencies initialized +97ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [InstanceLoader] AppModule dependencies initialized +1ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [InstanceLoader] TypeOrmCoreModule dependencies initialized +213ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [InstanceLoader] TypeOrmModule dependencies initialized +1ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [InstanceLoader] UsersModule dependencies initialized +1ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RoutesResolver] AppController {}: +14ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {, GET} route +18ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RoutesResolver] UsersController {/users}: +10ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {/users, POST} route +7ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {/users, GET} route +3ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {/users/:email, GET} route +1ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {/users/:id, PUT} route +11ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [RouterExplorer] Mapped {/users/:id, DELETE} route +1ms
[Nest] 33080   - 2021-02-01 2:36:58 â”œF10: PMâ”¤   [NestApplication] Nest application successfully started +2ms
</code></pre></div></div>

<p>ìš°í›„ ìš°í›„~ ìš°í›„~ ìš°í›„~ ì„±ê³µ!!
ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤.</p>

<h2 id="-ì•„ì§-í…ŒìŠ¤íŠ¸ê°€-ë‚¨ì•˜ë‹¤">ğŸ¤£ ì•„ì§ í…ŒìŠ¤íŠ¸ê°€ ë‚¨ì•˜ë‹¤!!!</h2>

<p>ì €ëŠ” Rest Client ë¼ëŠ” vscode extension ì„ ì´ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. postman, curl ì—¬ëŸ¬ë¶„ì´ í¸í•˜ì‹  íˆ´ì„ ì´ìš©í•´ì£¼ì„¸ìš”!!</p>

<p>ì ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ì„ í•˜ë©´!</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">    </span><span class="nf">POST</span> <span class="nn">http://localhost:3000/users</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="s">    Content-Type: application/json</span>

    {
        "username": "manynang",
        "email" : "nono@cat.co.kr",
        "password" : "manyang"
    }
</code></pre></div></div>

<p>ë‹¤ìŒê³¼ ê°™ì´ ë°ì´í„°ê°€ ì¶œë ¥ì´ ë©ë‹ˆë‹¤!!</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">    </span><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="s">    X-Powered-By: Express</span>
<span class="s">    Content-Type: application/json; charset=utf-8</span>
<span class="s">    Content-Length: 179</span>
<span class="s">    ETag: W/"b3-G/i5vHuN9KZDYAV9wTSwyMToetE"</span>
<span class="s">    Date: Mon, 01 Feb 2021 05:41:10 GMT</span>
<span class="s">    Connection: close</span>

    {
    "email": "nono@cat.co.kr",
    "password": "$argon2i$v=19$m=4096,t=3,p=1$LthoEnjA4KlaeaE/8YhMPg$2bNUqzjlCqbomBtDTkcYzTHjibaSrjefgJDzJWTvGFQ",
    "username": "manynang",
    "id": 1,
    "imageLink": ""
    }
</code></pre></div></div>

<p>ì›ìŠ¤ .. ë¹„ë°€ë²ˆí˜¸ê°€ ë‚˜ì˜¤ëŠ”êµ°ìš”â€¦ ì´ë˜ì„œ í…ŒìŠ¤íŠ¸ê°€ ì¤‘ìš”í•œê²ë‹ˆë‹¤.</p>

<p>ì €í¬ëŠ” ìœ ì € idë§Œ ê°€ì ¸ì˜¤ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
UserCreate save í•˜ëŠ” ë¶€ë¶„ì„</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">userRepository</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">newUser</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</code></pre></div></div>

<p>ì´ì™€ ê°™ì´ ë°”ê¿”ì¤ì‹œë‹¤.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">    </span><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="s">    X-Powered-By: Express</span>
<span class="s">    Content-Type: text/html; charset=utf-8</span>
<span class="s">    Content-Length: 1</span>
<span class="s">    ETag: W/"1-NWoZK3kTsExUV00Ywo1G5jlUKKs"</span>
<span class="s">    Date: Mon, 01 Feb 2021 05:50:44 GMT</span>
<span class="s">    Connection: close</span>

    1
</code></pre></div></div>

<p>ì ì„±ê³µ!</p>

<p>ì ë‹¤ì‹œ ìœ„ì— POST ê´€ë ¨ ë¬¸ì„ ë‹¤ì‹œ ë³´ë‚´ë©´?</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">    </span><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
<span class="s">    X-Powered-By: Express</span>
<span class="s">    Content-Type: application/json; charset=utf-8</span>
<span class="s">    Content-Length: 92</span>
<span class="s">    ETag: W/"5c-j/u2GjtMeXEpPJw+5WWgYELKwpM"</span>
<span class="s">    Date: Mon, 01 Feb 2021 05:54:56 GMT</span>
<span class="s">    Connection: close</span>

    {
    "message": "Input data validation falied",
    "error": {
        "username": "UserName is already exists"
    }
    }
</code></pre></div></div>

<p>ì„±ê³µ~~!!!!
ì¤‘ë³µëœ username ì„ ê±¸ë €ìŠµë‹ˆë‹¤ ã…œã…œ!!</p>

<hr />

<p>ê³ ìƒí–ˆìŠµë‹ˆë‹¤ ã…œã…œ!!!!</p>

<p>ë‹¤ìŒì—ëŠ” ìœ„ ì½”ë“œë¥¼ Refactor í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì°¾ì•„ëµ™ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤!!
ì˜¤ëŠ˜ë„ ì¦ê±°ìš´ í•˜ë£¨ ë³´ë‚´ì„¸ìš”!!</p>

<p>í”¼ë“œë°±ì€ í•­ìƒ í™˜ì˜ì…ë‹ˆë‹¤.</p>

  <hr />
</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
    <li>
      <h3>
        <a href="/nodejs/nodejs-1-what-is-nodejs/">
          Node.js ì˜ íŠ¹ì§•ê³¼ í•œê³„
          <small>01 Feb 2021</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/algorithms/algorithms-leetcode-45/">
          leetcode Jump Game II ë¬¸ì œí’€ê¸°
          <small>30 Jan 2021</small>
        </a>
      </h3>
    </li>
    
    <li>
      <h3>
        <a href="/algorithms/algorithms-leetcode-44/">
          leetcode Wildcard Matching ë¬¸ì œí’€ê¸°
          <small>30 Jan 2021</small>
        </a>
      </h3>
    </li>
    
  </ul>
</div>

</div>
  
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src="/public/js/script.js"></script>
  </body>
</html>
